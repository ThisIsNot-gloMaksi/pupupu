<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Онлайн графический редактор</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>

<h1>Онлайн графический редактор (OpenCV)</h1>

<div class="container">

    <div class="panel">
        <h3>Загрузка изображения</h3>
        <input type="file" id="file">
        <button onclick="upload()">Загрузить</button>
        <div></div>
        <canvas id="canvas" width="500"></canvas>
        <br>
    </div>

    <div class="panel">
        <h3>История изменений</h3>
        <button onclick="undo()">Undo</button>
        <button onclick="resetImage()">Reset</button>
    </div>


    <div class="panel">
        <h3>Масштабирование</h3>
        <label>fx: <input type="number" id="fx" value="1" step="0.1"></label>
        <label>fy: <input type="number" id="fy" value="1" step="0.1"></label>
        <button onclick="resize()">Применить</button>
    </div>

    <div class="panel">
        <h3>Обрезка</h3>
        <input type="number" id="x" placeholder="x">
        <input type="number" id="y" placeholder="y">
        <input type="number" id="w" placeholder="width">
        <input type="number" id="h" placeholder="height">
        <button onclick="crop()">Вырезать</button>
    </div>

    <div class="panel">
        <h3>Отражение</h3>
        <button onclick="flip(1)">Горизонтально</button>
        <button onclick="flip(0)">Вертикально</button>
        <button onclick="flip(-1)">Обе оси</button>
    </div>

    <div class="panel">
        <h3>Поворот</h3>
        <input type="number" id="angle" placeholder="Угол (°)">
        <button onclick="rotate()">Повернуть</button>
    </div>

    <div class="panel">
        <h3>Яркость / Контраст</h3>
        Контраст (alpha): <input type="number" id="alpha" value="1" step="0.1">
        Яркость (beta): <input type="number" id="beta" value="0" step="1">
        <button onclick="brightness()">Применить</button>
    </div>

    <div class="panel">
        <h3>Цветовой баланс</h3>
        R <input type="range" min="0" max="255" id="r" value="0">
        G <input type="range" min="0" max="255" id="g" value="0">
        B <input type="range" min="0" max="255" id="b" value="0">
        <button onclick="color()">Применить</button>
    </div>

    <div class="panel">
        <h3>Размытие изображения</h3>

        <label>Тип фильтра:
            <select id="blurType">
                <option value="average">Среднее</option>
                <option value="gaussian">Гауссово</option>
                <option value="median">Медианное</option>
            </select>
        </label>

        <label>Размер ядра:
            <input type="number" id="kernel" value="5" min="3" step="2">
        </label>
        <button onclick="blurPhoto()">Применить</button>
    </div>

    <div class="panel">
        <h3>Добавление шума</h3>

        <label>Тип шума:
            <select id="noiseType">
                <option value="gaussian">Гауссов</option>
                <option value="sp">Соль и перец</option>
            </select>
        </label>

        <label>Интенсивность:
            <input type="range" id="noiseAmount"
                   min="0.001" max="0.1" step="0.001" value="0.02">
        </label>

        <button onclick="applyNoise()">Применить</button>
    </div>

    <div class="panel">
        <h3>Цветовое пространство</h3>

        <select id="colorSpace">
            <option value="bgr">BGR</option>
            <option value="hsv">HSV</option>
        </select>

        <button onclick="changeColorSpace()">Применить</button>
    </div>
    <div class="panel">
        <h3>Поиск объекта по цвету</h3>

        <label>Цвет:
            <input type="color" id="objectColor">
        </label>

        <label>Цветовое пространство:
            <select id="searchSpace">
                <option value="rgb">RGB</option>
                <option value="hsv">HSV</option>
            </select>
        </label>

        <label>Допуск:
            <input type="number" id="tolerance" value="20" min="5" max="80">
        </label>

        <label>Режим:
            <select id="searchMode">
                <option value="box">Рамка</option>
                <option value="crop">Обрезка</option>
            </select>
        </label>

        <button onclick="findObject()">Найти</button>
    </div>

    <div class="panel">
    <h3>Выделение границ</h3>

    <label>Метод:
        <select id="edgeMethod" onchange="toggleEdgeParams()">
            <option value="sobel">Sobel</option>
            <option value="canny">Canny</option>
        </select>
    </label>

    <div id="sobelParams">
        <label>Размер ядра:
            <input type="number" id="ksize" value="3" min="3" step="2">
        </label>
    </div>

    <div id="cannyParams" style="display:none">
        <label>Порог 1:
            <input type="number" id="t1" value="100">
        </label>

        <label>Порог 2:
            <input type="number" id="t2" value="200">
        </label>
    </div>

    <br>
    <button onclick="applyEdges()">Применить</button>
</div>


    <div class="panel">
        <h3>Сохранение изображения</h3>

        <label>Формат:
            <select id="format" onchange="toggleQuality()">
                <option value="JPEG">JPEG</option>
                <option value="png">PNG</option>
                <option value="tiff">TIFF</option>
            </select>
        </label>

        <div id="qualityBlock">
            <label>Качество (JPEG):
                <input type="range" id="quality" min="10" max="100" value="95">
            </label>
        </div>

        <button onclick="saveImage()">Сохранить</button>
    </div>

    <div class="panel">
    <h3>Сегментация (OpenCV)</h3>

    <label>Алгоритм:
        <select id="segMethod" onchange="toggleSegParams()">
            <option value="kmeans">K-Means</option>
            <option value="meanshift">Mean Shift</option>
            <option value="dbscan">DBSCAN</option>
            <option value="snake">Snake Segmentation</option>
        </select>
    </label>

    <div id="kmeansParams">
        <label>K:
            <input type="number" id="k" value="3">
        </label>
    </div>

    <div id="meanshiftParams" style="display:none">
        <label>Spatial radius:
            <input type="number" id="sp" value="20">
        </label>
        <label>Color radius:
            <input type="number" id="sr" value="30">
        </label>
    </div>

    <br>
    <button onclick="applySegmentation()">Применить</button>
</div>




</div>

<script src="/static/script.js"></script>
</body>
</html>
